#full explanation https://johnshall.github.io/Shadowrocket-ADBlock-Rules-Forever/lazy_group.conf
[General]
# æ—è·¯ç³»ç»Ÿã€‚å¦‚æœç¦ç”¨æ­¤é€‰é¡¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›ç³»ç»Ÿé—®é¢˜ï¼Œå¦‚æ¨é€é€šçŸ¥å»¶è¿Ÿã€‚
bypass-system = true
# è·³è¿‡ä»£ç†ã€‚æ­¤é€‰é¡¹å¼ºåˆ¶è¿™äº›åŸŸåæˆ–IPçš„è¿æ¥èŒƒå›´ç”±Shadowrocket TUNæ¥å£æ¥å¤„ç†ï¼Œè€Œä¸æ˜¯Shadowrocketä»£ç†æœåŠ¡å™¨ã€‚æ­¤é€‰é¡¹ç”¨äºè§£å†³ä¸€äº›åº”ç”¨ç¨‹åºçš„ä¸€äº›å…¼å®¹æ€§é—®é¢˜ã€‚
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, captive.apple.com
# TUNæ—è·¯è·¯ç”±ã€‚Shadowrocket TUNæ¥å£åªèƒ½å¤„ç†TCPåè®®ã€‚ä½¿ç”¨æ­¤é€‰é¡¹å¯ä»¥ç»•è¿‡æŒ‡å®šçš„IPèŒƒå›´ï¼Œè®©å…¶ä»–åè®®é€šè¿‡ã€‚
tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 239.255.255.250/32
# DNSè¦†å†™ã€‚ä½¿ç”¨æ™®é€šDNSæˆ–åŠ å¯†DNSï¼ˆå¦‚dohã€doqã€dotç­‰ï¼‰è¦†ç›–é»˜è®¤çš„ç³»ç»ŸDNSã€‚æœ‰äº›dns over httpsæ”¯æŒhttp3ï¼Œæ‰€ä»¥å°è¯•æŸ¥è¯¢ï¼Œå¦‚æœæ”¯æŒå°±åˆ‡æ¢åˆ°http3ã€‚å¯åœ¨dohé“¾æ¥åé¢åŠ ä¸Š#no-h3å…³é—­ã€‚dohå¼ºåˆ¶é€šè¿‡h3æŸ¥è¯¢çš„å†™æ³•æ˜¯å°†â€œhttpsâ€æ”¹æˆâ€œh3â€ï¼Œå¦‚h3://dns.alidns.com/dns-queryã€‚
dns-server = 1.1.1.1,8.8.8.8
ipv6 = true
prefer-ipv6 = true
dns-fallback-system = false
# ç›´è¿çš„åŸŸåç±»è§„åˆ™ä½¿ç”¨ç³»ç»Ÿdnsè¿›è¡ŒæŸ¥è¯¢ã€‚falseè¡¨ç¤ºä¸å¯ç”¨ã€‚
dns-direct-system = false
# pingæ•°æ®åŒ…è‡ªåŠ¨å›å¤ã€‚
icmp-auto-reply = true
# ä¸å¼€å¯æ—¶ï¼ŒREJECTç­–ç•¥é»˜è®¤åªæœ‰åœ¨é…ç½®æ¨¡å¼ä¸‹ç”Ÿæ•ˆã€‚å¼€å¯åï¼Œå¯ä»¥ä»¤è¯¥ç­–ç•¥åœ¨å…¶ä»–å…¨å±€è·¯ç”±æ¨¡å¼ä¸‹éƒ½ç”Ÿæ•ˆã€‚
always-reject-url-rewrite = false
# ç§æœ‰IPåº”ç­”ã€‚å¦‚æœä¸å¯ç”¨è¯¥é€‰é¡¹ï¼ŒåŸŸåè§£æè¿”å›ç§æœ‰IPï¼ŒShadowrocketä¼šè®¤ä¸ºè¯¥åŸŸåè¢«åŠ«æŒè€Œå¼ºåˆ¶ä½¿ç”¨ä»£ç†ã€‚
private-ip-answer = true
# ç›´è¿åŸŸåè§£æå¤±è´¥åä½¿ç”¨ä»£ç†ã€‚falseè¡¨ç¤ºä¸å¯ç”¨ã€‚
dns-direct-fallback-proxy = false
# DNSåŠ«æŒã€‚æœ‰äº›è®¾å¤‡æˆ–è½¯ä»¶æ€»æ˜¯ä½¿ç”¨ç¡¬ç¼–ç çš„DNSæœåŠ¡å™¨ï¼Œä¾‹å¦‚Netflixé€šè¿‡Google DNS(8.8.8.8æˆ–8.8.4.4)å‘é€è¯·æ±‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹æ¥åŠ«æŒæŸ¥è¯¢ã€‚
hijack-dns = 8.8.8.8:53,8.8.4.4:53

[Proxy Group]
# ä»£ç†åˆ†ç»„ç±»å‹ï¼š
# select:æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹ã€‚
# url-test:è‡ªåŠ¨é€‰æ‹©å»¶è¿Ÿæœ€ä½èŠ‚ç‚¹ã€‚
# fallback:èŠ‚ç‚¹æŒ‚æ‰æ—¶è‡ªåŠ¨åˆ‡æ¢å…¶ä»–å¯ç”¨èŠ‚ç‚¹ã€‚
# load-balance:ä¸åŒè§„åˆ™çš„è¯·æ±‚ä½¿ç”¨åˆ†ç»„é‡Œçš„ä¸åŒèŠ‚ç‚¹è¿›è¡Œè¿æ¥ã€‚
# random:éšæœºä½¿ç”¨åˆ†ç»„é‡Œçš„ä¸åŒèŠ‚ç‚¹è¿›è¡Œè¿æ¥ã€‚
# ----------
# policy-regex-filterè¡¨ç¤ºæ­£åˆ™å¼æˆ–å…³é”®è¯ç­›é€‰ï¼Œå¸¸ç”¨å†™æ³•ï¼š
# ä¿ç•™èŠ‚ç‚¹åç§°å«æœ‰å…³é”®è¯Aå’ŒBçš„èŠ‚ç‚¹:
# (?=.*(A))^(?=.*(B))^.*$
# ä¿ç•™èŠ‚ç‚¹åç§°å«æœ‰å…³é”®è¯Aæˆ–Bçš„èŠ‚ç‚¹:
# A|B
# æ’é™¤èŠ‚ç‚¹åç§°å«æœ‰å…³é”®è¯Aæˆ–Bçš„èŠ‚ç‚¹:
# ^((?!(A|B)).)*$
# ä¿ç•™èŠ‚ç‚¹åç§°å«æœ‰å…³é”®è¯Aå¹¶æ’é™¤å«æœ‰å…³é”®è¯Bçš„èŠ‚ç‚¹:
# (?=.*(A).)^((?!(B)).)*$
# ----------
# ä»£ç†åˆ†ç»„å…¶ä»–è®¾ç½®å‚æ•°ï¼š
# interval:æŒ‡å®šé—´éš”å¤šé•¿æ—¶é—´åéœ€è¦é‡æ–°å‘èµ·æµ‹è¯•ã€‚
# timeout:å¦‚æœæµ‹è¯•åœ¨è¶…æ—¶å‰æœªå®Œæˆï¼Œæ”¾å¼ƒæµ‹è¯•ã€‚
# tolerance:åªæœ‰å½“æ–°ä¼˜èƒœè€…çš„åˆ†æ•°é«˜äºæ—§ä¼˜èƒœè€…çš„åˆ†æ•°åŠ ä¸Šå…¬å·®æ—¶ï¼Œæ‰ä¼šè¿›è¡Œçº¿è·¯æ›´æ¢ã€‚
# url:æŒ‡å®šè¦æµ‹è¯•çš„URLã€‚
# ----------
# ä¸å«æ­£åˆ™ç­›é€‰çš„ä»£ç†åˆ†ç»„ï¼Œç¤ºä¾‹ï¼š
# åç§°=ç±»å‹(å¦‚select,url-test,fallback,load-balance,random),ç­–ç•¥(å¦‚direct,proxy,è®¢é˜…åç§°,ä»£ç†åˆ†ç»„,èŠ‚ç‚¹),interval=æµ‹è¯•å‘¨æœŸ,timeout=è¶…æ—¶æ—¶é—´,tolerance=å…¬å·®,select=é»˜è®¤ç­–ç•¥(0è¡¨ç¤ºç¬¬ä¸€ä¸ªç­–ç•¥,1è¡¨ç¤ºç¬¬äºŒä¸ªç­–ç•¥,2è¡¨ç¤ºç¬¬ä¸‰ä¸ªç­–ç•¥â€¦â€¦),url=æµ‹è¯•åœ°å€
# å«æ­£åˆ™ç­›é€‰çš„ä»£ç†åˆ†ç»„ï¼Œç¤ºä¾‹ï¼š
# åç§°=ç±»å‹(å¦‚select,url-test,fallback,load-balance,random),policy-regex-filter=æ­£åˆ™å¼æˆ–å…³é”®è¯ç­›é€‰,interval=æµ‹è¯•å‘¨æœŸ,timeout=è¶…æ—¶æ—¶é—´,tolerance=å…¬å·®,select=é»˜è®¤ç­–ç•¥(0è¡¨ç¤ºç¬¬ä¸€ä¸ªç­–ç•¥,1è¡¨ç¤ºç¬¬äºŒä¸ªç­–ç•¥,2è¡¨ç¤ºç¬¬ä¸‰ä¸ªç­–ç•¥â€¦â€¦),url=æµ‹è¯•åœ°å€
# ----------
vps = select,freedom,interval=86400,timeout=5,select=0,url=http://www.gstatic.com/generate_204
Stream = select,ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡I,interval=86400,timeout=5,select=0,url=http://www.gstatic.com/generate_204
alwayson = fallback,PROXY,vps,interval=600,timeout=5,select=0,url=http://www.gstatic.com/generate_204
#policy-regex-filter=(PROXY|vps),



[Rule]
#
# å›½å†…å¤–åˆ’åˆ†ï¼Œå¯¹ä¸­å›½ç½‘ç«™ç›´è¿ï¼Œå¤–å›½ç½‘ç«™ä»£ç†ã€‚
#
# åŒ…å«å¹¿å‘Šè¿‡æ»¤
#
#ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡I
#ğŸ‡ºğŸ‡¸ ç¾å›½I
#ğŸ‡µğŸ‡­ è²å¾‹å®¾ 100å€æ‰£æµé‡

[Rule]
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/release/rule/Shadowrocket/Netflix/Netflix.list,Stream
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Disney/Disney.list,Stream
#proxy

#reject
#RULE-SET, https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Hijacking/Hijacking.list,REJECT-200
#RULE-SET, https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Privacy/Privacy.list,REJECT-200
#DOMAIN-SET, https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Privacy/Privacy_Domain.list,REJECT-200
#RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/release/rule/Shadowrocket/Advertising/Advertising.list,REJECT-200
#DOMAIN-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Advertising/Advertising_Domain.list,REJECT-200
#Bç«™çŸ¥ä¹å»å¹¿å‘Š
URL-REGEX,^https?:\/\/api\.bilibili\.com\/pgc\/season\/app\/related\/recommend\?,REJECT-200
URL-REGEX,^https?:\/\/api\.bilibili\.com\/x\/v2\/dm\/ad,REJECT-200
URL-REGEX,^https?:\/\/api\.zhihu\.com\/brand\/question\/\d+/card\?,REJECT-200
URL-REGEX,^https?:\/\/manga\.bilibili\.com\/twirp\/comic\.v\d\.Comic\/Flash,REJECT-200
URL-REGEX,^https?:\/\/www\.zhihu\.com\/api\/v4\/answers\/\d+\/recommendations,REJECT-200
URL-REGEX,^https?:\/\/www\.zhihu\.com\/api\/v\d+\/brand\/question/\d+/card\?,REJECT-200
URL-REGEX,^https?:\/\/www\.zhihu\.com\/appview\/(p|v2\/answer|zvideo)\/.*entry=(preload-topstory|preload-search|preload-subscription),REJECT-200



DOMAIN-SUFFIX,ampproject.org,PROXY # Google AMP issue#237

#laohu
DOMAIN-SUFFIX,tigerfintech.com,DIRECT
DOMAIN-SUFFIX,skytigris.cn,DIRECT
DOMAIN-SUFFIX,laohu8,DIRECT


#openai,chatgpt
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Bing/Bing.list,vps
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/OpenAI/OpenAI.list,vps
DOMAIN-SUFFIX,trafficmanager.net,vps
DOMAIN,trafficmanager.net,vps
DOMAIN-SUFFIX,bard.google.com,vps
DOMAIN-SUFFIX,bard.google.com,vps
DOMAIN,bard.google.com,vps
# æœ¬åœ°å±€åŸŸç½‘åœ°å€çš„è§„åˆ™é›†ã€‚
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Lan/Lan.list,DIRECT
GEOIP,CN,DIRECT
DOMAIN-SUFFIX,lan,DIRECT
DOMAIN-SUFFIX,local,DIRECT

FINAL,direct



[URL Rewrite]
^http://(www.)?google.cn https://www.google.com 302
# Googleæœç´¢å¼•æ“é˜²è·³è½¬çš„é‡å†™ã€‚
^https?://(www.)?(g|google).cn https://www.google.com 302
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302
# å…æ‹”å¡è§£é”TikTokçš„é‡å†™ï¼Œé»˜è®¤è§£é”åœ°åŒºä¸ºã€Œæ—¥æœ¬ã€ã€‚éœ€è¦æ¢åŒºæ—¶ï¼Œè¯·å°†ä¸‹é¢ä¸€è¡Œçš„â€œJPâ€ä¿®æ”¹æˆå…¶ä»–å›½å®¶æˆ–åœ°åŒºçš„è‹±æ–‡åç¼©å†™ï¼Œå¦‚â€œTWã€KRã€USâ€ç­‰ã€‚
(?<=_region=)CN(?=&) HK 307
(?<=&mcc_mnc=)4 2 307
^(https?:\/\/(tnc|dm)[\w-]+\.\w+\.com\/.+)(\?)(.+) $1$3 302
(^https?:\/\/*\.\w{4}okv.com\/.+&.+)(\d{2}\.3\.\d)(.+) $118.0$3 302


#DOMAIN-SUFFIX,openai.com,USCleanIp
#DOMAIN-SUFFIX,ai.com,USCleanIp
#DOMAIN-SUFFIX,openai.com.cdn.cloudflare.net,USCleanIp

#DOMAIN,openaiapi-site.azureedge.net,USCleanIp
#DOMAIN,chat.openai.com.cdn.cloudflare.net,USCleanIp
#DOMAIN,ai.com,USCleanIp
